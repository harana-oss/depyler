# Depyler TODO List

This document tracks all outstanding TODO comments across the codebase that need to be addressed.

## Code Generation & Transpilation

1. **Implement kwargs handling as named parameters**
   - Location: `crates/depyler-core/src/rust_gen/func_gen.rs:1309`
   - Description: Kwargs are currently appended as positional args. Need to implement proper named parameter handling.
   - Context: The `function_param_borrows` field was removed from `CodeGenContext`. Current kwargs handling is in `expr_gen.rs` line 1165.

2. **Track regex capture vs find in type system**
   - Location: `crates/depyler-core/src/rust_gen/expr_gen.rs:8827`
   - Description: Need to track whether regex used `.captures()` vs `.find()` in the type system.
   - Context: `match.groups()` returns a tuple of captured groups, but this requires proper tracking of regex method usage.

3. **Track file open mode to distinguish text vs binary**
   - Location: `crates/depyler-core/src/rust_gen/expr_gen.rs:8977`
   - Description: Need to determine if file was opened in text or binary mode to generate correct read operations.
   - Context: Currently defaults to text mode (`read_to_string`) for `f.read()` calls.

## Agent & Daemon Features

4. **Implement automatic daemon restart logic**
   - Location: `crates/depyler/src/agent/daemon.rs:229`
   - Description: Auto-restart is currently only a status flag. Need to implement actual restart mechanism.
   - Context: When `auto_restart` is enabled and health check fails, status updates to `Restarting` but no actual restart occurs. Restart must be triggered manually using `depyler agent restart`.

## Migration & Analysis

5. **Implement none-as-error detection**
   - Location: `crates/depyler-core/src/migration_suggestions.rs:1254`
   - Description: Detection of unsafe None handling patterns is not yet implemented.
   - Context: Test at line 761 has `#[ignore]` attribute due to this missing feature.

## Python Standard Library Module Mappings

The following Python standard library modules need proper Rust mappings implemented in the module mapper:

### I/O and Serialization
6. **Map Python module `io`** (7 files affected)
   - Files: Various stdlib test files for pickle, gzip, zipfile, configparser
   
7. **Map Python module `pickle`** (2 files affected)
   - Files: `examples/stdlib/pickle_module.rs`, `examples/stdlib/test_pickle_module.rs`

8. **Map Python module `gzip`** (2 files affected)
   - Files: `examples/stdlib/gzip_module.rs`, `examples/stdlib/test_gzip_module.rs`

9. **Map Python module `zipfile`** (2 files affected)
   - Files: `examples/stdlib/zipfile_module.rs`, `examples/stdlib/test_zipfile_module.rs`

### Configuration and Data Structures
10. **Map Python module `configparser`** (2 files affected)
    - Files: `examples/stdlib/configparser_module.rs`, `examples/stdlib/test_configparser_module.rs`

11. **Map Python module `enum`** (2 files affected)
    - Files: `examples/stdlib/enum_module.rs`, `examples/stdlib/test_enum_module.rs`

### Data Processing and Algorithms
12. **Map Python module `statistics`** (2 files affected)
    - Files: `examples/stdlib/statistics_module.rs`, `examples/stdlib/test_statistics_module.rs`

13. **Map Python module `heapq`** (2 files affected)
    - Files: `examples/stdlib/heapq_module.rs`, `examples/stdlib/test_heapq_module.rs`

14. **Map Python module `bisect`** (2 files affected)
    - Files: `examples/stdlib/bisect_module.rs`, `examples/stdlib/test_bisect_module.rs`

15. **Map Python module `operator`** (2 files affected)
    - Files: `examples/stdlib/operator_module.rs`, `examples/stdlib/test_operator_module.rs`

16. **Map Python module `copy`** (2 files affected)
    - Files: `examples/stdlib/copy_module.rs`, `examples/stdlib/test_copy_module.rs`

### String Processing and XML
17. **Map Python module `string`** (3 files affected)
    - Files: `examples/stdlib/string_module.rs`, `examples/stdlib/test_string_module.rs`, `examples/string_processing/text_processing_combined.rs`

18. **Map Python module `xml.etree.ElementTree`** (2 files affected)
    - Files: `examples/stdlib/xml_etree_module.rs`, `examples/stdlib/test_xml_etree_module.rs`

### Process Management and Classes
19. **Map Python module `subprocess`** (1 file affected)
    - Files: `examples/validation/test_all.rs`

20. **Map Python module `dataclasses`** (2 files affected)
    - Files: `examples/classes/test_dataclass.rs`, `examples/classes/test_basic_class.rs`

## Implementation Notes

- **Module Mapping Strategy**: All "Map Python module" TODOs are generated by the module mapper at `crates/depyler-core/src/module_mapper.rs:377` when a Python module doesn't have a registered mapping.
- **Priority**: Items 1-5 are core functionality improvements. Items 6-20 are standard library coverage expansions.
- **Testing**: Most module mapping TODOs have corresponding test files that can be used to verify implementations.

## Task Status Summary

- **Total Tasks**: 20
- **Code Generation**: 3 tasks
- **Agent Features**: 1 task  
- **Analysis Features**: 1 task
- **Module Mappings**: 15 tasks (covering ~14 unique Python modules)
